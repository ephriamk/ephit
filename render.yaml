services:
  - type: web
    name: ephitup
    runtime: docker
    dockerfilePath: ./Dockerfile.single
    dockerContext: .
    plan: starter  # Note: 512MB RAM may be tight. Consider upgrading to 'standard' (2GB) for production
    healthCheckPath: /
    envVars:
      # Optional: System-level API keys (users can add their own keys in Settings)
      # These are only used as fallback - users can add keys via UI at /settings
      # - key: OPENAI_API_KEY
      #   sync: false
      
      # Security (Auto-generated - JWT by Render, Fernet by app to persistent storage)
      - key: JWT_SECRET
        generateValue: true
      # FERNET_SECRET_KEY is auto-generated by the app on first run and saved to /mydata/.secrets/fernet.key
      # This ensures it persists across deployments without manual setup
      
      # Optional: AWS S3 for podcast audio storage
      - key: S3_BUCKET_NAME
        sync: false
      - key: S3_ENDPOINT_URL
        sync: false
      - key: AWS_ACCESS_KEY_ID
        sync: false
      - key: AWS_SECRET_ACCESS_KEY
        sync: false
      - key: S3_REGION
        value: "us-east-2"
      
      # Database Configuration
      - key: SURREAL_URL
        value: "ws://localhost:8000/rpc"
      - key: SURREAL_USER
        value: "root"
      - key: SURREAL_PASSWORD
        generateValue: true
      - key: SURREAL_NAMESPACE
        value: "open_notebook"
      - key: SURREAL_DATABASE
        value: "production"
      
      # Frontend Configuration
      - key: PORT
        value: "8502"
      - key: INTERNAL_API_URL
        value: "http://localhost:5055"
